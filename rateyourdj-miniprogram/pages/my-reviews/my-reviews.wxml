<!--pages/my-reviews/my-reviews.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>{{texts.loading}}</text>
  </view>

  <!-- è¯„è®ºåˆ—è¡¨ -->
  <view wx:elif="{{reviews.length > 0}}" class="reviews-list">
    <view
      wx:for="{{reviews}}"
      wx:key="id"
      class="review-card"
      bindtap="goToDJDetail"
      data-id="{{item.dj_id}}"
    >
      <!-- DJ ä¿¡æ¯ -->
      <view class="dj-info">
        <text class="dj-name">{{item.dj_name}}</text>
        <text class="review-date">{{item.formattedDate}}</text>
      </view>

      <!-- è¯„åˆ† -->
      <view class="rating-section">
        <view class="overall-rating">
          <view class="stars">
            <text wx:for="{{item.stars.full}}" wx:key="index" class="star">â˜…</text>
            <text wx:for="{{item.stars.empty}}" wx:key="index" class="star empty">â˜†</text>
          </view>
          <text class="rating-value">{{item.overall_rating}}</text>
        </view>

        <view class="detail-ratings">
          <text class="detail-item">{{texts.set}}: {{item.set_rating}}</text>
          <text class="detail-item">{{texts.performance}}: {{item.performance_rating}}</text>
          <text class="detail-item">{{texts.personality}}: {{item.personality_rating}}</text>
        </view>
      </view>

      <!-- æ ‡ç­¾ -->
      <view wx:if="{{item.tagList.length > 0}}" class="tags">
        <text wx:for="{{item.tagList}}" wx:key="index" class="tag">{{item}}</text>
      </view>

      <!-- è¯„è®ºå†…å®¹ -->
      <text wx:if="{{item.comment}}" class="comment">{{item.comment}}</text>

      <!-- æ“ä½œåŒºåŸŸ -->
      <view class="actions">
        <view class="action-item">
          <text class="icon">ğŸ‘</text>
          <text class="count">{{item.helpful_count}}</text>
        </view>
        <view class="action-btns">
          <button
            class="action-btn share-btn"
            open-type="share"
            data-review="{{item}}"
            catchtap="preventBubble"
          >
            åˆ†äº«
          </button>
          <button
            class="action-btn delete-btn"
            catchtap="deleteReview"
            data-id="{{item.id}}"
          >
            åˆ é™¤
          </button>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more">
      <text wx:if="{{loadingMore}}" class="loading-text">{{texts.loading}}</text>
      <text wx:elif="{{hasMore}}" class="more-btn" bindtap="loadMore">åŠ è½½æ›´å¤š</text>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-state">
    <text class="icon">â€”</text>
    <text class="text">{{texts.noReviews}}</text>
  </view>
</view>
