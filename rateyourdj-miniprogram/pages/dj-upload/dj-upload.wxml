<!--pages/dj-upload/dj-upload.wxml-->
<view class="container">
  <view class="form-section">
    <view class="form-title">上传DJ资料</view>

    <!-- DJ照片 -->
    <view class="form-item">
      <text class="label">DJ照片 *</text>
      <view class="image-upload" bindtap="chooseImage">
        <image wx:if="{{localImagePath}}" src="{{localImagePath}}" mode="aspectFill" class="preview-image" />
        <view wx:else class="upload-placeholder">
          <text class="upload-icon">📷</text>
          <text class="upload-text">点击选择照片</text>
        </view>
      </view>
    </view>

    <!-- DJ名称 -->
    <view class="form-item">
      <text class="label">DJ名称 *</text>
      <input
        class="input"
        placeholder="请输入DJ名称"
        value="{{name}}"
        bindinput="onNameInput"
      />
    </view>

    <!-- 城市选择 - 使用微信 region 组件 -->
    <view class="form-item">
      <text class="label">城市 *</text>
      <picker
        mode="region"
        bindchange="onCityChange"
        value="{{cityRegion}}"
        custom-item="{{customCityItem}}"
      >
        <view class="picker">
          {{city || '请选择城市'}}
        </view>
      </picker>
    </view>

    <!-- 厂牌选择 - 可选择现有或自定义 -->
    <view class="form-item">
      <text class="label">厂牌</text>
      <picker
        bindchange="onLabelChange"
        value="{{labelIndex}}"
        range="{{labelOptions}}"
      >
        <view class="picker">
          {{label || '请选择厂牌（选填）'}}
        </view>
      </picker>
    </view>

    <!-- 自定义厂牌输入框（当选择"自定义"时显示） -->
    <view class="form-item" wx:if="{{showCustomLabel}}">
      <text class="label">自定义厂牌</text>
      <input
        class="input"
        placeholder="请输入厂牌名称"
        value="{{customLabel}}"
        bindinput="onCustomLabelInput"
      />
    </view>

    <!-- 音乐风格选择 - 多选标签 -->
    <view class="form-item">
      <text class="label">音乐风格</text>
      <view class="tag-selector">
        <view
          class="tag-item {{selectedStyles.indexOf(item.name) > -1 ? 'selected' : ''}}"
          wx:for="{{styleTagOptions}}"
          wx:key="id"
          bindtap="onStyleTagTap"
          data-name="{{item.name}}"
        >
          {{item.name}}
        </view>
      </view>
      <view class="hint-text">最多选择 5 个标签</view>
      <!-- 调试信息 -->
      <view class="hint-text" style="color: red; margin-top: 10rpx;">
        调试: 已选择 {{selectedStyles.length}} 个标签: {{selectedStyles}}
      </view>
    </view>

    <!-- 提交按钮 -->
    <button
      class="submit-btn"
      bindtap="handleSubmit"
      disabled="{{uploading}}"
    >
      {{uploading ? '上传中...' : '提交'}}
    </button>
  </view>
</view>
