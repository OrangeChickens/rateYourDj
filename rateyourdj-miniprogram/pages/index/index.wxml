<!-- 首页 -->
<view class="container">
  <!-- 统计数据看板 -->
  <stats-dashboard
    wx:if="{{dashboardStats}}"
    stats="{{dashboardStats}}"
    texts="{{statsTexts}}" />

  <!-- 最近评价 -->
  <recent-reviews
    wx:if="{{recentReviews && recentReviews.length > 0}}"
    reviews="{{recentReviews}}"
    texts="{{recentReviewsTexts}}" />

  <!-- 搜索框 -->
  <view class="search-section">
    <view class="search-bar" bindtap="goToSearch">
      <text class="search-icon">SEARCH</text>
      <text class="search-placeholder">{{searchPlaceholder}}</text>
    </view>
  </view>

  <!-- 城市选择 -->
  <view class="city-section" bindtap="goToCityList">
    <text class="city-icon">CITY</text>
    <text class="city-name">{{selectedCity}}</text>
    <text class="city-arrow">▼</text>
  </view>

  <!-- A-Z 筛选 -->
  <view class="letter-filter">
    <scroll-view scroll-x="{{true}}" class="letter-scroll">
      <view class="letter-list">
        <text
          class="letter-item {{selectedLetter === '' ? 'active' : ''}}"
          bindtap="selectLetter"
          data-letter="">
          ALL
        </text>
        <text
          wx:for="{{letters}}"
          wx:key="*this"
          class="letter-item {{selectedLetter === item ? 'active' : ''}}"
          bindtap="selectLetter"
          data-letter="{{item}}">
          {{item}}
        </text>
      </view>
    </scroll-view>
  </view>

  <!-- 热门DJ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">{{hotDJsTitle}}</text>
    </view>

    <view class="dj-list" wx:if="{{hotDJs.length > 0}}">
      <view
        class="dj-card"
        wx:for="{{hotDJs}}"
        wx:key="id"
        bindtap="goToDJDetail"
        data-id="{{item.id}}"
      >
        <!-- DJ卡片 -->
        <view class="dj-card-header">
          <view class="image-wrapper skeleton">
            <image
              class="dj-avatar"
              src="{{item.photo_url || '/images/default-avatar.png'}}"
              mode="aspectFill"
              lazy-load="{{true}}"
            />
          </view>
          <view class="dj-info">
            <text class="dj-name">{{item.name}}</text>
            <view class="dj-meta">
              <text class="dj-city">{{item.city}}</text>
              <text class="dj-label" wx:if="{{item.label}}">{{item.label}}</text>
            </view>
          </view>
        </view>

        <view class="dj-card-body">
          <!-- 评分 -->
          <view class="rating-section">
            <view class="overall-rating">
              <text class="rating-number rating-{{item.overall_rating >= 4 ? 'high' : item.overall_rating >= 3 ? 'medium' : 'low'}}">{{item.overall_rating}}</text>
              <view class="rating-stars">
                <text class="star star-filled" wx:for="{{item.fullStars}}" wx:key="index">★</text>
                <text class="star star-empty" wx:for="{{item.emptyStars}}" wx:key="index">★</text>
              </view>
            </view>
            <view class="rating-info">
              <text class="review-count">{{item.review_count}}条评论</text>
              <text class="would-choose" wx:if="{{item.would_choose_again_percent !== null}}">
                <text class="would-choose-percent">{{item.would_choose_again_percent}}%</text>
                <text class="would-choose-label">会再次捧场</text>
              </text>
            </view>
          </view>

          <!-- 标签 -->
          <view class="tags" wx:if="{{item.music_style}}">
            <text class="tag" wx:for="{{item.styleList}}" wx:key="index">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 初始加载中 -->
    <view class="loading" wx:if="{{loading && currentPage === 1}}">
      <text>{{loadingText}}</text>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:elif="{{!loading && hotDJs.length === 0}}">
      <text class="empty-icon">—</text>
      <text class="empty-text">{{noDataText}}</text>
    </view>

    <!-- 底部加载状态 -->
    <view class="load-more" wx:if="{{hotDJs.length > 0}}">
      <text wx:if="{{loading}}" class="loading-text">{{loadingText}}</text>
    </view>
  </view>
</view>
