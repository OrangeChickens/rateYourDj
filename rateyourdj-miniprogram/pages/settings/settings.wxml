<!--pages/settings/settings.wxml-->
<view class="container">
  <!-- Áî®Êà∑‰ø°ÊÅØÂå∫Âüü -->
  <view class="user-section">
    <view wx:if="{{isLoggedIn}}" class="user-info">
      <image
        src="{{userInfo.avatar_url || '/images/default-avatar.png'}}"
        class="avatar"
        mode="aspectFill"
      />
      <view class="user-details">
        <text class="nickname">{{userInfo.nickname}}</text>
        <view class="stats">
          <text class="stat-item">{{reviewCount}} {{texts.reviewCount}}</text>
          <text class="separator">¬∑</text>
          <text class="stat-item">{{favoriteCount}} {{texts.favoriteCount}}</text>
        </view>
        <!-- Ë∞ÉËØïÔºöÊòæÁ§∫Áî®Êà∑ËßíËâ≤ -->
        <text class="role-debug" style="font-size: 24rpx; color: #999; margin-top: 10rpx;">ËßíËâ≤: {{userInfo.role || 'Êó†'}}</text>
      </view>
    </view>

    <view wx:else class="login-prompt">
      <image src="/images/default-avatar.png" class="avatar" mode="aspectFill" />
      <button class="login-btn" bindtap="handleLogin">{{texts.login}}</button>
    </view>
  </view>

  <!-- ÂäüËÉΩËèúÂçï -->
  <view class="menu-section">
    <!-- ÊàëÁöÑËØÑËÆ∫ -->
    <view class="menu-item" bindtap="goToMyReviews">
      <text class="menu-icon">‚úçÔ∏è</text>
      <text class="menu-label">{{texts.myReviews}}</text>
      <text class="menu-arrow">‚Ä∫</text>
    </view>

    <!-- ÊàëÁöÑÊî∂Ëóè -->
    <view class="menu-item" bindtap="goToMyFavorites">
      <text class="menu-icon">‚≠ê</text>
      <text class="menu-label">{{texts.myFavorites}}</text>
      <text class="menu-arrow">‚Ä∫</text>
    </view>
  </view>

  <!-- ÁÆ°ÁêÜÂëòËèúÂçï -->
  <view class="menu-section" wx:if="{{isAdmin}}">
    <view class="menu-item" bindtap="goToUploadDJ">
      <text class="menu-icon">‚ûï</text>
      <text class="menu-label">‰∏ä‰º†DJËµÑÊñô</text>
      <text class="menu-arrow">‚Ä∫</text>
    </view>
  </view>

  <!-- ËÆæÁΩÆËèúÂçï -->
  <view class="menu-section">
    <!-- ËØ≠Ë®ÄËÆæÁΩÆ -->
    <view class="menu-item" bindtap="switchLanguage">
      <text class="menu-icon">üåê</text>
      <text class="menu-label">{{texts.language}}</text>
      <text class="menu-value">{{currentLanguage === 'zh-CN' ? texts.chinese : texts.english}}</text>
      <text class="menu-arrow">‚Ä∫</text>
    </view>

    <!-- ÂÖ≥‰∫é -->
    <view class="menu-item" bindtap="showAbout">
      <text class="menu-icon">‚ÑπÔ∏è</text>
      <text class="menu-label">{{texts.about}}</text>
      <text class="menu-value">v1.0.0</text>
      <text class="menu-arrow">‚Ä∫</text>
    </view>
  </view>

  <!-- ÈÄÄÂá∫ÁôªÂΩï -->
  <view wx:if="{{isLoggedIn}}" class="logout-section">
    <button class="logout-btn" bindtap="handleLogout">{{texts.logout}}</button>
  </view>
</view>
