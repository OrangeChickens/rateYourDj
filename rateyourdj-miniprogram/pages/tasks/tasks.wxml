<!-- pages/tasks/tasks.wxml -->
<view class="tasks-container">
  <!-- å¤´éƒ¨çŠ¶æ€ -->
  <view class="tasks-header">
    <view class="user-status">
      <text class="status-icon">ğŸ«</text>
      <view class="status-info">
        <text class="status-title">é‚€è¯·ç é¢åº¦</text>
        <text class="status-number">{{inviteQuota}} ä¸ª</text>
      </view>
      <button class="manage-btn" bindtap="goToInvites">ç®¡ç†</button>
    </view>

    <view class="invite-stats">
      <view class="stat-item">
        <text class="stat-label">å·²å‘å‡º</text>
        <text class="stat-value">{{invitesSent}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">å·²æ¥å—</text>
        <text class="stat-value">{{invitesAccepted}}</text>
      </view>
    </view>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨ -->
  <scroll-view scroll-y class="tasks-list">
    <!-- æ–°æ‰‹ä»»åŠ¡ -->
    <view class="task-section">
      <view class="section-header">
        <text class="section-icon">ğŸ¯</text>
        <text class="section-title">æ–°æ‰‹ä»»åŠ¡</text>
      </view>

      <view wx:for="{{beginnerTasks}}" wx:key="code"
            class="task-card {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-icon">{{item.icon}}</view>
        <view class="task-content">
          <view class="task-header">
            <text class="task-name">{{item.name}}</text>
            <view class="task-reward">
              <text class="reward-icon">ğŸ«</text>
              <text class="reward-amount">+{{item.reward}}</text>
            </view>
          </view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-progress">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <!-- ä»»åŠ¡çŠ¶æ€ -->
        <view wx:if="{{item.canClaim}}" class="task-badge claim">
          <text>é¢†å–</text>
        </view>
        <view wx:elif="{{item.completed}}" class="task-badge completed">
          <text>âœ“</text>
        </view>
        <view wx:else class="task-badge pending">
          <text>â†’</text>
        </view>
      </view>
    </view>

    <!-- è¿›é˜¶ä»»åŠ¡ -->
    <view class="task-section">
      <view class="section-header">
        <text class="section-icon">ğŸš€</text>
        <text class="section-title">è¿›é˜¶ä»»åŠ¡</text>
      </view>

      <view wx:for="{{advancedTasks}}" wx:key="code"
            class="task-card {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-icon">{{item.icon}}</view>
        <view class="task-content">
          <view class="task-header">
            <text class="task-name">{{item.name}}</text>
            <view class="task-reward">
              <text class="reward-icon">ğŸ«</text>
              <text class="reward-amount">+{{item.reward}}</text>
            </view>
          </view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-progress">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <!-- ä»»åŠ¡çŠ¶æ€ -->
        <view wx:if="{{item.canClaim}}" class="task-badge claim">
          <text>é¢†å–</text>
        </view>
        <view wx:elif="{{item.completed}}" class="task-badge completed">
          <text>âœ“</text>
        </view>
        <view wx:else class="task-badge pending">
          <text>â†’</text>
        </view>
      </view>
    </view>

    <!-- VIP ä»»åŠ¡ -->
    <view class="task-section vip">
      <view class="section-header">
        <text class="section-icon">â­</text>
        <text class="section-title">VIP ä»»åŠ¡</text>
        <text class="vip-badge">é«˜å¥–åŠ±</text>
      </view>

      <view wx:for="{{vipTasks}}" wx:key="code"
            class="task-card vip {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-icon">{{item.icon}}</view>
        <view class="task-content">
          <view class="task-header">
            <text class="task-name">{{item.name}}</text>
            <view class="task-reward">
              <text class="reward-icon">ğŸ«</text>
              <text class="reward-amount">+{{item.reward}}</text>
            </view>
          </view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-progress">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <!-- ä»»åŠ¡çŠ¶æ€ -->
        <view wx:if="{{item.canClaim}}" class="task-badge claim">
          <text>é¢†å–</text>
        </view>
        <view wx:elif="{{item.completed}}" class="task-badge completed">
          <text>âœ“</text>
        </view>
        <view wx:else class="task-badge pending">
          <text>â†’</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨é—´è· -->
    <view style="height: 40rpx;"></view>
  </scroll-view>
</view>
