<!-- pages/tasks/tasks.wxml -->
<view class="tasks-container">
  <!-- 头部状态 -->
  <view class="tasks-header">
    <view class="quota-card">
      <view class="quota-info">
        <text class="quota-label">邀请码额度</text>
        <text class="quota-number">{{inviteQuota}} 个</text>
      </view>
      <button class="manage-btn" bindtap="goToInvites">管理</button>
    </view>

    <view class="stats-row">
      <view class="stat-box">
        <text class="stat-label">已发出</text>
        <text class="stat-value">{{invitesSent}}</text>
      </view>
      <view class="stat-box">
        <text class="stat-label">已接受</text>
        <text class="stat-value">{{invitesAccepted}}</text>
      </view>
    </view>
  </view>

  <!-- 任务列表 -->
  <scroll-view scroll-y class="tasks-list">
    <!-- 新手任务 -->
    <view class="task-section">
      <view class="section-header">
        <text class="section-title">新手任务</text>
      </view>

      <view wx:for="{{beginnerTasks}}" wx:key="code"
            class="task-card {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-left">
          <view class="task-title">{{item.name}}</view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-footer">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <view class="task-right">
          <view class="reward-badge">+{{item.reward}}</view>
          <view wx:if="{{item.canClaim}}" class="action-btn claim">领取</view>
          <view wx:elif="{{item.completed}}" class="action-btn completed">✓</view>
          <view wx:else class="action-btn pending">→</view>
        </view>
      </view>
    </view>

    <!-- 进阶任务 -->
    <view class="task-section">
      <view class="section-header">
        <text class="section-title">进阶任务</text>
      </view>

      <view wx:for="{{advancedTasks}}" wx:key="code"
            class="task-card {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-left">
          <view class="task-title">{{item.name}}</view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-footer">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <view class="task-right">
          <view class="reward-badge">+{{item.reward}}</view>
          <view wx:if="{{item.canClaim}}" class="action-btn claim">领取</view>
          <view wx:elif="{{item.completed}}" class="action-btn completed">✓</view>
          <view wx:else class="action-btn pending">→</view>
        </view>
      </view>
    </view>

    <!-- VIP 任务 -->
    <view class="task-section">
      <view class="section-header">
        <text class="section-title">VIP 任务</text>
      </view>

      <view wx:for="{{vipTasks}}" wx:key="code"
            class="task-card vip {{item.completed ? 'completed' : ''}}"
            bindtap="onTaskTap"
            data-code="{{item.code}}">
        <view class="task-left">
          <view class="task-title">{{item.name}}</view>
          <text class="task-desc">{{item.desc}}</text>
          <view class="task-footer">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress / item.target * 100}}%"></view>
            </view>
            <text class="progress-text">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>

        <view class="task-right">
          <view class="reward-badge">+{{item.reward}}</view>
          <view wx:if="{{item.canClaim}}" class="action-btn claim">领取</view>
          <view wx:elif="{{item.completed}}" class="action-btn completed">✓</view>
          <view wx:else class="action-btn pending">→</view>
        </view>
      </view>
    </view>

    <!-- 底部间距 -->
    <view style="height: 40rpx;"></view>
  </scroll-view>
</view>
