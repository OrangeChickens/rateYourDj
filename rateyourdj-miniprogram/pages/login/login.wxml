<!--pages/login/login.wxml-->
<view class="container">
  <view class="header">
    <text class="title">烂u盘</text>
    <text class="subtitle">RATE YOUR DJ</text>
  </view>

  <view class="login-form">
    <!-- 头像选择 -->
    <view class="avatar-section">
      <text class="label">头像（可选）</text>
      <button class="avatar-btn" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar" disabled="{{uploading}}">
        <image
          src="{{avatarUrl || '/images/default-avatar.png'}}"
          class="avatar {{uploading ? 'uploading' : ''}}"
          mode="aspectFill"
        />
        <text class="avatar-tip" wx:if="{{!uploading && !uploadedAvatarUrl}}">{{avatarTip}}</text>
        <text class="avatar-tip uploading" wx:if="{{uploading}}">上传中...</text>
        <text class="avatar-tip success" wx:if="{{!uploading && uploadedAvatarUrl}}">✓ 已上传新头像</text>
      </button>
    </view>

    <!-- 昵称输入 -->
    <view class="nickname-section">
      <text class="label">昵称 *</text>
      <input
        class="nickname-input"
        type="nickname"
        placeholder="请输入昵称"
        placeholder-style="color: #666; font-weight: 600; font-size: 22rpx;"
        value="{{nickname}}"
        bindinput="onNicknameInput"
        maxlength="20"
      />
    </view>

    <!-- 隐私政策同意 -->
    <view class="privacy-section">
      <label class="privacy-checkbox">
        <checkbox checked="{{privacyChecked}}" bindtap="onPrivacyCheck" color="#000" />
        <view class="privacy-text">
          <text>我已阅读并同意</text>
          <text class="link" catchtap="goToUserAgreement">《用户服务协议》</text>
          <text>和</text>
          <text class="link" catchtap="goToPrivacyPolicy">《隐私政策》</text>
        </view>
      </label>
    </view>

    <!-- 登录按钮 -->
    <button class="login-btn" bindtap="handleLogin" disabled="{{!nickname || !privacyChecked}}">
      登录
    </button>
  </view>
</view>
